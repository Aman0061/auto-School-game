-- SQL скрипт для добавления 15 автошкол
-- Выполните этот скрипт в вашей базе данных Supabase

-- Вставка автошкол
INSERT INTO driving_schools (
  id, name, city, region, address, phone, categories, 
  price_from, rating, reviews_count, lat, lng, 
  description, site, whatsapp, telegram, logo_cdn, 
  payed, approved, created_at, updated_at
) VALUES 
-- 1. Автошкола "Эксперт" (Бишкек, с короной)
(
  gen_random_uuid(), 'Автошкола "Эксперт"', 'Бишкек', 'Бишкек',
  'ул. Советская, 123, офис 45', '+996 555 123 456',
  ARRAY['B', 'C', 'D'],
  25000, 4.8, 127,
  42.8746, 74.6122,
  'Профессиональная автошкола с 15-летним опытом. Индивидуальный подход к каждому ученику, современные методики обучения.',
  'https://expert-auto.kg', '+996 555 123 456', '@expert_auto',
  'https://example.com/logo1.png',
  true, true, NOW(), NOW()
),

-- 2. Автошкола "Мастер" (Ош)
(
  gen_random_uuid(), 'Автошкола "Мастер"', 'Ош', 'Ош',
  'ул. Ленина, 78, 2 этаж', '+996 555 234 567',
  ARRAY['B', 'C'],
  22000, 4.6, 89,
  40.5144, 72.8153,
  'Качественное обучение вождению в Оше. Опытные инструкторы, удобное расписание.',
  'https://master-auto.kg', '+996 555 234 567', '@master_auto',
  'https://example.com/logo2.png',
  false, true, NOW(), NOW()
),

-- 3. Автошкола "Профи" (Бишкек, с короной)
(
  gen_random_uuid(), 'Автошкола "Профи"', 'Бишкек', 'Бишкек',
  'ул. Чуй, 45, ТЦ "Азия Молл"', '+996 555 345 678',
  ARRAY['A', 'B', 'C', 'D', 'E'],
  30000, 4.9, 203,
  42.8765, 74.6145,
  'Элитная автошкола с полным спектром категорий. Премиум-обучение, VIP-сервис.',
  'https://profi-auto.kg', '+996 555 345 678', '@profi_auto',
  'https://example.com/logo3.png',
  true, true, NOW(), NOW()
),

-- 4. Автошкола "Старт" (Чуйская область)
(
  gen_random_uuid(), 'Автошкола "Старт"', 'Токмок', 'Чуйская область',
  'ул. Абдырахманова, 12', '+996 555 456 789',
  ARRAY['B', 'C'],
  20000, 4.4, 67,
  42.8275, 75.2846,
  'Доступное обучение вождению в Токмоке. Демократичные цены, качественное образование.',
  'https://start-auto.kg', '+996 555 456 789', '@start_auto',
  'https://example.com/logo4.png',
  false, true, NOW(), NOW()
),

-- 5. Автошкола "Успех" (Иссык-Кульская область)
(
  gen_random_uuid(), 'Автошкола "Успех"', 'Каракол', 'Иссык-Кульская область',
  'ул. Токтогула, 34', '+996 555 567 890',
  ARRAY['B', 'C'],
  23000, 4.5, 78,
  42.4907, 78.3936,
  'Надежная автошкола в Караколе. Стабильные результаты, довольные выпускники.',
  'https://uspeh-auto.kg', '+996 555 567 890', '@uspeh_auto',
  'https://example.com/logo5.png',
  false, true, NOW(), NOW()
),

-- 6. Автошкола "Лидер" (Бишкек)
(
  gen_random_uuid(), 'Автошкола "Лидер"', 'Бишкек', 'Бишкек',
  'ул. Московская, 156, офис 23', '+996 555 678 901',
  ARRAY['B', 'C', 'D'],
  27000, 4.7, 145,
  42.8789, 74.6167,
  'Передовая автошкола с инновационными методами обучения. Высокий процент сдачи экзаменов.',
  'https://lider-auto.kg', '+996 555 678 901', '@lider_auto',
  'https://example.com/logo6.png',
  false, true, NOW(), NOW()
),

-- 7. Автошкола "Надежда" (Нарынская область)
(
  gen_random_uuid(), 'Автошкола "Надежда"', 'Нарын', 'Нарынская область',
  'ул. Советская, 89', '+996 555 789 012',
  ARRAY['B', 'C'],
  21000, 4.3, 45,
  41.4283, 75.9911,
  'Доступное обучение в Нарыне. Подготовка водителей для горных дорог.',
  'https://nadezhda-auto.kg', '+996 555 789 012', '@nadezhda_auto',
  'https://example.com/logo7.png',
  false, true, NOW(), NOW()
),

-- 8. Автошкола "Виктория" (Таласская область)
(
  gen_random_uuid(), 'Автошкола "Виктория"', 'Талас', 'Таласская область',
  'ул. Манаса, 67', '+996 555 890 123',
  ARRAY['B', 'C'],
  22000, 4.4, 56,
  42.5227, 72.2429,
  'Качественное обучение в Таласе. Опытные инструкторы, индивидуальный подход.',
  'https://viktoria-auto.kg', '+996 555 890 123', '@viktoria_auto',
  'https://example.com/logo8.png',
  false, true, NOW(), NOW()
),

-- 9. Автошкола "Форсаж" (Бишкек, с короной)
(
  gen_random_uuid(), 'Автошкола "Форсаж"', 'Бишкек', 'Бишкек',
  'ул. Ахунбаева, 78, ТЦ "Бишкек Парк"', '+996 555 901 234',
  ARRAY['A', 'B', 'C', 'D'],
  32000, 4.9, 178,
  42.8756, 74.6134,
  'Современная автошкола с симуляторами и VR-обучением. Инновационные технологии.',
  'https://forsazh-auto.kg', '+996 555 901 234', '@forsazh_auto',
  'https://example.com/logo9.png',
  true, true, NOW(), NOW()
),

-- 10. Автошкола "Дружба" (Джалал-Абадская область)
(
  gen_random_uuid(), 'Автошкола "Дружба"', 'Джалал-Абад', 'Джалал-Абадская область',
  'ул. Ленина, 123', '+996 555 012 345',
  ARRAY['B', 'C'],
  20000, 4.2, 34,
  40.9375, 72.9782,
  'Дружелюбная атмосфера обучения в Джалал-Абаде. Доступные цены.',
  'https://druzhba-auto.kg', '+996 555 012 345', '@druzhba_auto',
  'https://example.com/logo10.png',
  false, true, NOW(), NOW()
),

-- 11. Автошкола "Пионер" (Баткенская область)
(
  gen_random_uuid(), 'Автошкола "Пионер"', 'Баткен', 'Баткенская область',
  'ул. Абдырахманова, 45', '+996 555 123 789',
  ARRAY['B', 'C'],
  19000, 4.1, 28,
  39.7307, 71.1809,
  'Первая автошкола в Баткене. Надежное обучение, проверенные методики.',
  'https://pioner-auto.kg', '+996 555 123 789', '@pioner_auto',
  'https://example.com/logo11.png',
  false, true, NOW(), NOW()
),

-- 12. Автошкола "Столица" (Бишкек)
(
  gen_random_uuid(), 'Автошкола "Столица"', 'Бишкек', 'Бишкек',
  'ул. Ибраимова, 234, офис 12', '+996 555 234 890',
  ARRAY['B', 'C', 'D', 'E'],
  28000, 4.6, 134,
  42.8778, 74.6156,
  'Столичная автошкола с высокими стандартами. Подготовка профессиональных водителей.',
  'https://stolitsa-auto.kg', '+996 555 234 890', '@stolitsa_auto',
  'https://example.com/logo12.png',
  false, true, NOW(), NOW()
),

-- 13. Автошкола "Ориент" (Ош)
(
  gen_random_uuid(), 'Автошкола "Ориент"', 'Ош', 'Ош',
  'ул. Курманжан Датка, 56', '+996 555 345 901',
  ARRAY['B', 'C', 'D'],
  24000, 4.5, 89,
  40.5156, 72.8167,
  'Ориентированная на результат автошкола в Оше. Высокий процент успешной сдачи.',
  'https://orient-auto.kg', '+996 555 345 901', '@orient_auto',
  'https://example.com/logo13.png',
  false, true, NOW(), NOW()
),

-- 14. Автошкола "Академия" (Бишкек, с короной)
(
  gen_random_uuid(), 'Автошкола "Академия"', 'Бишкек', 'Бишкек',
  'ул. Тоголок Молдо, 89, офис 67', '+996 555 456 012',
  ARRAY['A', 'B', 'C', 'D', 'E'],
  35000, 4.9, 267,
  42.8767, 74.6145,
  'Академический подход к обучению вождению. Теоретические и практические занятия.',
  'https://akademiya-auto.kg', '+996 555 456 012', '@akademiya_auto',
  'https://example.com/logo14.png',
  true, true, NOW(), NOW()
),

-- 15. Автошкола "Классика" (Чуйская область)
(
  gen_random_uuid(), 'Автошкола "Классика"', 'Кант', 'Чуйская область',
  'ул. Абдырахманова, 23', '+996 555 567 123',
  ARRAY['B', 'C'],
  21000, 4.3, 67,
  42.8892, 74.8506,
  'Классическое обучение вождению в Канте. Проверенные временем методики.',
  'https://klassika-auto.kg', '+996 555 567 123', '@klassika_auto',
  'https://example.com/logo15.png',
  false, true, NOW(), NOW()
);

-- Вставка категорий прав (если таблица license_categories пуста)
INSERT INTO license_categories (id, code, name) VALUES
(1, 'A', 'Мотоциклы'),
(2, 'B', 'Легковые автомобили'),
(3, 'C', 'Грузовые автомобили'),
(4, 'D', 'Автобусы'),
(5, 'E', 'Прицепы')
ON CONFLICT (id) DO NOTHING;

-- Вставка цен для автошкол (используем подзапросы для получения UUID)
INSERT INTO school_prices (id, school_id, category_id, price, currency, is_active)
SELECT 
  gen_random_uuid(),
  ds.id,
  lc.id,
  CASE 
    WHEN lc.code = 'A' THEN 20000
    WHEN lc.code = 'B' THEN 25000
    WHEN lc.code = 'C' THEN 35000
    WHEN lc.code = 'D' THEN 45000
    WHEN lc.code = 'E' THEN 15000
  END,
  'RUB',
  true
FROM driving_schools ds
CROSS JOIN license_categories lc
WHERE ds.name IN ('Автошкола "Эксперт"', 'Автошкола "Профи"', 'Автошкола "Форсаж"', 'Автошкола "Академия"')
  AND (
    (ds.name = 'Автошкола "Эксперт"' AND lc.code IN ('B', 'C', 'D')) OR
    (ds.name = 'Автошкола "Профи"' AND lc.code IN ('A', 'B', 'C', 'D', 'E')) OR
    (ds.name = 'Автошкола "Форсаж"' AND lc.code IN ('A', 'B', 'C', 'D')) OR
    (ds.name = 'Автошкола "Академия"' AND lc.code IN ('A', 'B', 'C', 'D', 'E'))
  );

-- Проверка вставленных данных
SELECT 
  ds.name,
  ds.city,
  ds.region,
  ds.payed,
  ds.rating,
  ds.price_from,
  array_length(ds.categories, 1) as categories_count
FROM driving_schools ds
ORDER BY ds.payed DESC, ds.rating DESC;
